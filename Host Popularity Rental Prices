WITH host_ AS
(SELECT 
    concat(price, room_type, host_since, zipcode) as host_id,
    CASE 
        WHEN number_of_reviews = 0 THEN 'New'
        WHEN number_of_reviews BETWEEN 1 AND 5 THEN 'Rising'
        WHEN number_of_reviews BETWEEN 6 AND 15 THEN 'Trending Up'
        WHEN number_of_reviews BETWEEN 16 AND 40 THEN 'Popular'
        WHEN number_of_reviews > 40 THEN 'Hot'
    END AS host_popular,
    price
FROM airbnb_host_searches)

SELECT 
    host_popular,
    min(price) AS min_price,
    avg(price) AS avg_price,
    max(price) AS max_price
FROM host_
GROUP BY host_popular
